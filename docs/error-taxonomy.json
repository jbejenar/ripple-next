{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Ripple Next Error Taxonomy",
  "description": "Machine-parseable error taxonomy for AI agent auto-triage. Maps failure modes to categories, severities, and remediation paths. 62 classified error codes across 17 categories. See ADR-018, ADR-019, ADR-020, ADR-021, ADR-022, docs/accessibility.md, docs/session-observability.md, and docs/performance.md.",
  "version": "1.10.0",
  "codeFormat": "RPL-<CATEGORY>-<NNN>",
  "severityLevels": {
    "error": "Blocks progress. Must be fixed before proceeding.",
    "warning": "Non-blocking but should be addressed. May affect some workflows.",
    "info": "Informational. No action required."
  },
  "categories": {
    "ENV": "Environment and setup failures",
    "LINT": "Linting and code style failures",
    "TYPE": "TypeScript type checking failures",
    "TEST": "Test execution failures",
    "BUILD": "Build and compilation failures",
    "DEPLOY": "Deployment and infrastructure failures",
    "POLICY": "Policy gate and governance failures",
    "IAC": "Infrastructure-as-code policy violations (sst.config.ts)",
    "FLEET": "Fleet governance and template drift violations (RN-024)",
    "A11Y": "Accessibility and WCAG compliance violations (RN-042)",
    "SESSION": "Agent session observability and metrics failures (RN-043)",
    "SCAFFOLD": "Project scaffold generator failures (RN-041)",
    "DOCS": "Documentation and context file governance (RN-044, ADR-020)",
    "API": "API contract and OpenAPI specification violations (RN-051, ADR-021)",
    "AUTH": "OIDC/OAuth identity provider failures (RN-045)",
    "FEEDBACK": "Fleet feedback submission and validation failures (RN-052, ADR-022)",
    "PERF": "Web performance budget violations — Core Web Vitals (RN-050)"
  },
  "errors": [
    {
      "code": "RPL-ENV-001",
      "category": "ENV",
      "severity": "error",
      "message": "Node.js version below minimum requirement (>=22)",
      "gate": "doctor",
      "remediation": [
        "Install Node.js 22+ via nvm: nvm install $(cat .nvmrc)",
        "Or use fnm: fnm use",
        "Verify: node -v"
      ],
      "automatable": false
    },
    {
      "code": "RPL-ENV-002",
      "category": "ENV",
      "severity": "error",
      "message": "pnpm version does not match pinned version in packageManager field",
      "gate": "doctor",
      "remediation": [
        "Enable corepack: corepack enable pnpm",
        "This auto-activates the version from package.json packageManager field",
        "Verify: pnpm -v"
      ],
      "automatable": false
    },
    {
      "code": "RPL-ENV-003",
      "category": "ENV",
      "severity": "error",
      "message": "Required environment variable missing or invalid",
      "gate": "validate:env",
      "remediation": [
        "Copy .env.example to .env: cp .env.example .env",
        "Fill in required values: DATABASE_URL, NUXT_DATABASE_URL, REDIS_URL",
        "Run: pnpm validate:env"
      ],
      "automatable": true
    },
    {
      "code": "RPL-ENV-004",
      "category": "ENV",
      "severity": "warning",
      "message": "Optional environment variable has invalid format",
      "gate": "validate:env",
      "remediation": [
        "Check .env.example for expected format",
        "Run: pnpm validate:env for specific field details"
      ],
      "automatable": false
    },
    {
      "code": "RPL-ENV-005",
      "category": "ENV",
      "severity": "error",
      "message": "pnpm-lock.yaml missing",
      "gate": "doctor",
      "remediation": [
        "Run: pnpm install",
        "Commit pnpm-lock.yaml to version control"
      ],
      "automatable": true
    },
    {
      "code": "RPL-ENV-006",
      "category": "ENV",
      "severity": "warning",
      "message": "node_modules not installed",
      "gate": "doctor",
      "remediation": [
        "Run: pnpm install --frozen-lockfile",
        "Or run: pnpm bootstrap (for first-time setup)"
      ],
      "automatable": true
    },
    {
      "code": "RPL-ENV-007",
      "category": "ENV",
      "severity": "warning",
      "message": "Docker not available (needed for local dev and testcontainers)",
      "gate": "doctor",
      "remediation": [
        "Install Docker Desktop or Docker Engine",
        "Start Docker: systemctl start docker (Linux) or open Docker Desktop",
        "This is optional but needed for integration tests and local dev services"
      ],
      "automatable": false
    },
    {
      "code": "RPL-ENV-008",
      "category": "ENV",
      "severity": "warning",
      "message": "Node.js version differs from pinned version in .nvmrc",
      "gate": "doctor",
      "remediation": [
        "Run: nvm use (reads .nvmrc)",
        "Or: fnm use",
        "This ensures exact version match across all environments"
      ],
      "automatable": false
    },
    {
      "code": "RPL-LINT-001",
      "category": "LINT",
      "severity": "error",
      "message": "ESLint errors found",
      "gate": "lint",
      "remediation": [
        "Run: pnpm lint to see errors",
        "Auto-fix: pnpm lint:fix",
        "Common causes: console.log (use console.warn/error), explicit any (use unknown)"
      ],
      "automatable": true
    },
    {
      "code": "RPL-LINT-002",
      "category": "LINT",
      "severity": "error",
      "message": "console.log/console.info used in production code",
      "gate": "lint",
      "remediation": [
        "Replace console.log with console.warn or console.error",
        "Or remove the console statement entirely",
        "Exempt files: *.test.ts, migrate.ts, seed.ts, *.handler.ts"
      ],
      "automatable": true
    },
    {
      "code": "RPL-LINT-003",
      "category": "LINT",
      "severity": "error",
      "message": "Explicit 'any' type used",
      "gate": "lint",
      "remediation": [
        "Replace 'any' with 'unknown' and add type guards",
        "Or use a more specific type",
        "Example: function parse(data: unknown): MyType { ... }"
      ],
      "automatable": true
    },
    {
      "code": "RPL-TYPE-001",
      "category": "TYPE",
      "severity": "error",
      "message": "TypeScript type errors found",
      "gate": "typecheck",
      "remediation": [
        "Run: pnpm typecheck to see errors",
        "Fix type mismatches, missing imports, or incorrect signatures",
        "If Nuxt auto-import types are missing: npx nuxi prepare apps/web"
      ],
      "automatable": false
    },
    {
      "code": "RPL-TYPE-002",
      "category": "TYPE",
      "severity": "error",
      "message": "Missing Nuxt auto-import types (.nuxt directory stale)",
      "gate": "typecheck",
      "remediation": [
        "Run: npx nuxi prepare apps/web",
        "This regenerates the .nuxt/ types directory",
        "Then re-run: pnpm typecheck"
      ],
      "automatable": true
    },
    {
      "code": "RPL-TEST-001",
      "category": "TEST",
      "severity": "error",
      "message": "Test suite failures",
      "gate": "test",
      "remediation": [
        "Run: pnpm test to see failures",
        "Check test output for assertion errors",
        "Run specific package: pnpm test --filter @ripple/<package>"
      ],
      "automatable": false
    },
    {
      "code": "RPL-TEST-002",
      "category": "TEST",
      "severity": "error",
      "message": "Coverage threshold not met",
      "gate": "test",
      "remediation": [
        "Check vitest.workspace.ts for tier-specific thresholds",
        "Tier 1 (auth, db, queue): 60% lines/functions, 50% branches",
        "Tier 2 (email, storage, events, cms): 40% lines/functions, 30% branches",
        "Tier 3 (UI, services): 20% lines/functions, 10% branches",
        "Add tests to increase coverage. Never lower thresholds."
      ],
      "automatable": false
    },
    {
      "code": "RPL-TEST-003",
      "category": "TEST",
      "severity": "error",
      "message": "Conformance test failures for provider implementation",
      "gate": "test",
      "remediation": [
        "Run the conformance suite for your provider",
        "Implement all interface methods from packages/<concern>/types.ts",
        "See packages/testing/conformance/ for the test suite"
      ],
      "automatable": false
    },
    {
      "code": "RPL-BUILD-001",
      "category": "BUILD",
      "severity": "error",
      "message": "TypeScript compilation failed",
      "gate": "build",
      "remediation": [
        "Run: pnpm typecheck to see errors",
        "Fix compilation errors before building",
        "Check tsconfig.json for correct configuration"
      ],
      "automatable": false
    },
    {
      "code": "RPL-BUILD-002",
      "category": "BUILD",
      "severity": "error",
      "message": "Missing dependency",
      "gate": "build",
      "remediation": [
        "Run: pnpm install --frozen-lockfile",
        "If new dependency needed: pnpm add <package> --filter @ripple/<package>",
        "For workspace deps: pnpm add @ripple/<dep> --filter @ripple/<package> --workspace"
      ],
      "automatable": true
    },
    {
      "code": "RPL-BUILD-003",
      "category": "BUILD",
      "severity": "error",
      "message": "Nuxt build failure",
      "gate": "build",
      "remediation": [
        "Run: pnpm build to see full error",
        "Check for import errors, missing modules, or config issues",
        "Try: npx nuxi prepare apps/web before building"
      ],
      "automatable": false
    },
    {
      "code": "RPL-DEPLOY-001",
      "category": "DEPLOY",
      "severity": "error",
      "message": "Health check failure after deployment",
      "gate": "deploy",
      "remediation": [
        "Check /api/health endpoint for specific check failures",
        "Verify DATABASE_URL and REDIS_URL are set in the deployed environment",
        "Check CloudWatch logs for error details",
        "Consider rollback: npx sst deploy --stage <previous-stage>"
      ],
      "automatable": false
    },
    {
      "code": "RPL-DEPLOY-002",
      "category": "DEPLOY",
      "severity": "error",
      "message": "Missing AWS credentials or permissions",
      "gate": "deploy",
      "remediation": [
        "Ensure AWS credentials are configured",
        "CI uses OIDC role assumption — check the workflow's role-to-assume setting",
        "Local: aws configure or set AWS_PROFILE"
      ],
      "automatable": false
    },
    {
      "code": "RPL-DEPLOY-003",
      "category": "DEPLOY",
      "severity": "error",
      "message": "SST deployment failure",
      "gate": "deploy",
      "remediation": [
        "Check sst.config.ts for configuration errors",
        "Review the SST deployment output for specific resource failures",
        "Try: npx sst deploy --stage pr-<number> for isolated testing"
      ],
      "automatable": false
    },
    {
      "code": "RPL-POLICY-001",
      "category": "POLICY",
      "severity": "error",
      "message": "Readiness manifest drift detected",
      "gate": "check:readiness",
      "remediation": [
        "Run: pnpm check:readiness to see drift details",
        "Update docs/readiness.json to match codebase reality",
        "Common causes: new package not added, stale blocker, missing test files"
      ],
      "automatable": true
    },
    {
      "code": "RPL-POLICY-002",
      "category": "POLICY",
      "severity": "error",
      "message": "Quarantine policy violation",
      "gate": "check:quarantine",
      "remediation": [
        "Run: pnpm check:quarantine to see violations",
        "Common violations: expired quarantine (>14 days), missing issue link, budget exceeded (>5%)",
        "Fix the flaky test or extend quarantine with justification"
      ],
      "automatable": false
    },
    {
      "code": "RPL-POLICY-003",
      "category": "POLICY",
      "severity": "error",
      "message": "Quarantined test in Tier 1 package (not allowed)",
      "gate": "check:quarantine",
      "remediation": [
        "Tier 1 packages (auth, db, queue) do not allow quarantined tests",
        "Fix the flaky test immediately or rewrite it",
        "See ADR-013 for quarantine policy details"
      ],
      "automatable": false
    },
    {
      "code": "RPL-POLICY-004",
      "category": "POLICY",
      "severity": "error",
      "message": "Published package API changed without changeset",
      "gate": "changeset",
      "remediation": [
        "Run: pnpm changeset",
        "Select the affected package(s) and semver bump type",
        "Commit the generated .changeset/*.md file with your PR"
      ],
      "automatable": true
    },
    {
      "code": "RPL-IAC-001",
      "category": "IAC",
      "severity": "error",
      "message": "Production stage missing protection flags (removal: retain, protect: true)",
      "gate": "check:iac",
      "remediation": [
        "Ensure app() returns removal: 'retain' and protect: true for production stage",
        "Pattern: removal: input?.stage === 'production' ? 'retain' : 'remove'",
        "Pattern: protect: input?.stage === 'production'"
      ],
      "automatable": false
    },
    {
      "code": "RPL-IAC-002",
      "category": "IAC",
      "severity": "warning",
      "message": "S3 bucket uses wildcard CORS origins",
      "gate": "check:iac",
      "remediation": [
        "Replace allowOrigins: ['*'] with specific domain origins",
        "Example: allowOrigins: ['https://example.vic.gov.au']",
        "Or add exception comment: // iac-policy-exception: IAC-002 — <justification>"
      ],
      "automatable": false
    },
    {
      "code": "RPL-IAC-003",
      "category": "IAC",
      "severity": "error",
      "message": "Public-facing service listens on HTTP instead of HTTPS",
      "gate": "check:iac",
      "remediation": [
        "Ensure public-facing services use HTTPS (port 443)",
        "Pattern: listen: '443/https'",
        "Do not expose HTTP (port 80) publicly"
      ],
      "automatable": false
    },
    {
      "code": "RPL-IAC-004",
      "category": "IAC",
      "severity": "warning",
      "message": "ECS or database scaling exceeds policy limits",
      "gate": "check:iac",
      "remediation": [
        "ECS: scaling max should not exceed 50 instances",
        "Database: max ACU should not exceed 32",
        "Review docs/iac-policies.json for current limits"
      ],
      "automatable": false
    },
    {
      "code": "RPL-IAC-005",
      "category": "IAC",
      "severity": "warning",
      "message": "Lambda timeout exceeds 15-minute limit",
      "gate": "check:iac",
      "remediation": [
        "Lambda has a hard 15-minute execution limit",
        "Use ECS Fargate for longer workloads",
        "See docs/lambda-vs-ecs.md for the compute decision framework"
      ],
      "automatable": false
    },
    {
      "code": "RPL-IAC-006",
      "category": "IAC",
      "severity": "error",
      "message": "Hardcoded AWS ARN or account ID found in SST config",
      "gate": "check:iac",
      "remediation": [
        "Use SST Resource linking instead of hardcoded ARNs",
        "Pattern: link: [resource] instead of arn: 'arn:aws:...'",
        "Never embed AWS account IDs in configuration"
      ],
      "automatable": false
    },
    {
      "code": "RPL-IAC-007",
      "category": "IAC",
      "severity": "error",
      "message": "Database or cache resource deployed without VPC",
      "gate": "check:iac",
      "remediation": [
        "Database and cache resources must reference the VPC",
        "Pattern: new sst.aws.Postgres('Name', { vpc })",
        "Pattern: new sst.aws.Redis('Name', { vpc })"
      ],
      "automatable": false
    },
    {
      "code": "RPL-FLEET-001",
      "category": "FLEET",
      "severity": "error",
      "message": "Security-critical fleet drift detected — governed surface has diverged from golden path",
      "gate": "check:fleet-drift",
      "remediation": [
        "Run: pnpm check:fleet-drift --json to see full drift report",
        "Security-critical surfaces: composite actions, toolchain pins, security config, IaC policies",
        "Accept the automated sync PR or manually update the drifted files",
        "SLA: fix within 7 days"
      ],
      "automatable": true
    },
    {
      "code": "RPL-FLEET-002",
      "category": "FLEET",
      "severity": "error",
      "message": "Standards-required fleet drift detected — governed surface has diverged from golden path",
      "gate": "check:fleet-drift",
      "remediation": [
        "Run: pnpm check:fleet-drift --json to see full drift report",
        "Standards surfaces: CI workflows, quality scripts, ESLint config, error taxonomy",
        "Accept the automated sync PR or manually update the drifted files",
        "SLA: fix within 30 days"
      ],
      "automatable": true
    },
    {
      "code": "RPL-FLEET-003",
      "category": "FLEET",
      "severity": "warning",
      "message": "Recommended fleet drift detected — advisory surface has diverged from golden path",
      "gate": "check:fleet-drift",
      "remediation": [
        "Run: pnpm check:fleet-drift --json to see drift details",
        "Recommended drifts are advisory only and do not block CI",
        "Consider updating to stay aligned with golden path best practices"
      ],
      "automatable": true
    },
    {
      "code": "RPL-FLEET-004",
      "category": "FLEET",
      "severity": "error",
      "message": "Fleet policy manifest missing or invalid",
      "gate": "check:fleet-drift",
      "remediation": [
        "Ensure docs/fleet-policy.json exists and is valid JSON",
        "The fleet policy manifest defines governed surfaces and sync strategies",
        "Copy from the golden-path repo if missing: docs/fleet-policy.json"
      ],
      "automatable": true
    },
    {
      "code": "RPL-FLEET-005",
      "category": "FLEET",
      "severity": "warning",
      "message": "Fleet policy exception has expired",
      "gate": "check:fleet-drift",
      "remediation": [
        "Fleet policy exceptions expire after 90 days",
        "Review the exception and either renew it with updated justification or fix the drift",
        "Exception format: // fleet-policy-exception: <SURFACE-ID> — <justification>"
      ],
      "automatable": false
    },
    {
      "code": "RPL-FLEET-006",
      "category": "FLEET",
      "severity": "info",
      "message": "Fleet compliance score below target threshold",
      "gate": "check:fleet-drift",
      "remediation": [
        "Run: pnpm fleet:compliance --json to see per-repo compliance scores",
        "Target: minimum 80% compliance score",
        "Address security-critical drifts first, then standards-required"
      ],
      "automatable": false
    },
    {
      "code": "RPL-A11Y-001",
      "category": "A11Y",
      "severity": "error",
      "message": "Critical or serious WCAG 2.1 AA accessibility violation detected",
      "gate": "test:a11y",
      "remediation": [
        "Run: pnpm test:a11y -- --json to see full violation details",
        "Each violation includes a helpUrl with fix guidance from Deque University",
        "Common fixes: add alt text, fix color contrast, add form labels, ensure keyboard access",
        "See docs/accessibility.md for component checklist"
      ],
      "automatable": false
    },
    {
      "code": "RPL-A11Y-002",
      "category": "A11Y",
      "severity": "warning",
      "message": "Moderate or minor WCAG 2.1 AA accessibility violation detected",
      "gate": "test:a11y",
      "remediation": [
        "Run: pnpm test:a11y -- --json to see violation details",
        "Moderate/minor violations are non-blocking but should be addressed",
        "Review the helpUrl for each violation for specific remediation guidance"
      ],
      "automatable": false
    },
    {
      "code": "RPL-SESSION-001",
      "category": "SESSION",
      "severity": "error",
      "message": "Session logger initialization failed (missing .sessions directory or write permission)",
      "gate": "session:start",
      "remediation": [
        "Ensure .sessions/ directory exists and is writable",
        "Run: mkdir -p .sessions",
        "Check disk space and file permissions"
      ],
      "automatable": true
    },
    {
      "code": "RPL-SESSION-002",
      "category": "SESSION",
      "severity": "warning",
      "message": "Session log file corrupted or unreadable",
      "gate": "agent:metrics",
      "remediation": [
        "Check .sessions/ for malformed JSON files",
        "Remove corrupt files: find .sessions -name '*.json' -empty -delete",
        "Corrupted files are skipped during aggregation — no data loss for other sessions"
      ],
      "automatable": true
    },
    {
      "code": "RPL-SESSION-003",
      "category": "SESSION",
      "severity": "info",
      "message": "No session data available for aggregation",
      "gate": "agent:metrics",
      "remediation": [
        "Start tracking sessions: pnpm session:start",
        "End sessions to record data: pnpm session:end -- --run-gates",
        "Session data is opt-in — no action required if observability is not needed"
      ],
      "automatable": false
    },
    {
      "code": "RPL-SCAFFOLD-001",
      "category": "SCAFFOLD",
      "severity": "error",
      "message": "Scaffold target directory does not exist",
      "gate": "generate:scaffold",
      "remediation": [
        "Create the target directory before running the scaffold generator",
        "Example: mkdir -p /path/to/my-project",
        "Then run: pnpm generate:scaffold /path/to/my-project --name=my-project"
      ],
      "automatable": true
    },
    {
      "code": "RPL-SCAFFOLD-002",
      "category": "SCAFFOLD",
      "severity": "warning",
      "message": "Scaffold file already exists in target directory (skipped)",
      "gate": "generate:scaffold",
      "remediation": [
        "Use --force flag to overwrite existing files",
        "Example: pnpm generate:scaffold /path/to/repo --force",
        "Or delete specific files manually before re-running"
      ],
      "automatable": true
    },
    {
      "code": "RPL-SCAFFOLD-003",
      "category": "SCAFFOLD",
      "severity": "error",
      "message": "Scaffold path traversal blocked — target path outside root",
      "gate": "generate:scaffold",
      "remediation": [
        "Ensure the target directory path is absolute and valid",
        "Do not use paths with .. that escape the target root",
        "Example: pnpm generate:scaffold /absolute/path/to/repo"
      ],
      "automatable": false
    },
    {
      "code": "RPL-DOCS-001",
      "category": "DOCS",
      "severity": "warning",
      "message": "Context file approaching size limit — CLAUDE.md > 60 lines or AGENTS.md > 220 lines",
      "gate": "check:context-size",
      "remediation": [
        "Review ADR-020 for context file minimalism principles",
        "Move domain-specific content to .github/instructions/ files",
        "Only keep content that prevents CI failures if unknown",
        "Run: pnpm check:context-size --json for detailed report"
      ],
      "automatable": false
    },
    {
      "code": "RPL-DOCS-002",
      "category": "DOCS",
      "severity": "error",
      "message": "Context file exceeds hard size limit — CLAUDE.md > 80 lines or AGENTS.md > 280 lines",
      "gate": "check:context-size",
      "remediation": [
        "Review ADR-020 for context file minimalism principles",
        "Move domain-specific content to .github/instructions/ files",
        "Remove command catalogs, directory listings, and CI details",
        "Only keep content that prevents CI failures if unknown",
        "Run: pnpm check:context-size --json for detailed report"
      ],
      "automatable": false
    },
    {
      "code": "RPL-API-001",
      "category": "API",
      "severity": "error",
      "message": "OpenAPI spec drift detected — committed spec does not match generated output from oRPC router",
      "gate": "check:api-contract",
      "remediation": [
        "Run: pnpm generate:openapi to regenerate docs/api/openapi.json",
        "Commit the updated spec with your changes",
        "This drift occurs when router definitions change without regenerating the spec"
      ],
      "automatable": true
    },
    {
      "code": "RPL-API-002",
      "category": "API",
      "severity": "error",
      "message": "Breaking change detected in public API (visibility: 'public') without version bump",
      "gate": "check:api-breaking",
      "remediation": [
        "Public API changes that remove or rename endpoints, parameters, or response fields are breaking",
        "Bump the API version (/v1/ → /v2/) and add migration notes",
        "Or mark the old endpoint as deprecated and add the new one alongside it",
        "See ADR-021 for versioning and deprecation policy"
      ],
      "automatable": false
    },
    {
      "code": "RPL-API-003",
      "category": "API",
      "severity": "info",
      "message": "Non-breaking API change detected — new endpoints, methods, or optional fields added",
      "gate": "check:api-breaking",
      "remediation": [
        "Non-breaking changes are informational and do not block CI",
        "Review the change report: pnpm check:api-breaking -- --json",
        "Ensure downstream consumers are aware of new capabilities",
        "Update API documentation if needed"
      ],
      "automatable": false
    },
    {
      "code": "RPL-AUTH-001",
      "category": "AUTH",
      "severity": "error",
      "message": "OIDC issuer discovery failed — cannot reach .well-known/openid-configuration",
      "gate": "test:integration",
      "remediation": [
        "Verify the OIDC issuer URL is correct and reachable",
        "Check network connectivity to the identity provider",
        "Ensure the IdP is running and the realm exists (Keycloak: /realms/<name>)",
        "If using a custom CA, ensure it is trusted by the Node.js process"
      ],
      "automatable": false
    },
    {
      "code": "RPL-AUTH-002",
      "category": "AUTH",
      "severity": "error",
      "message": "OIDC redirect URI mismatch — callback URL not registered with the identity provider",
      "gate": "test:integration",
      "remediation": [
        "Ensure the redirect_uri in OidcConfig matches the URI registered in the IdP client settings",
        "Keycloak: Admin Console → Clients → <client-id> → Valid Redirect URIs",
        "The URI must match exactly including protocol, host, port, and path"
      ],
      "automatable": false
    },
    {
      "code": "RPL-AUTH-003",
      "category": "AUTH",
      "severity": "error",
      "message": "OIDC token validation failed — clock skew, invalid signature, or expired token",
      "gate": "test:integration",
      "remediation": [
        "Check system clock synchronization between app server and IdP (use NTP)",
        "Verify the IdP's signing keys are accessible via the JWKS endpoint",
        "Check that the ID token audience (aud) matches the configured client_id",
        "If clock skew is persistent, configure a tolerance window"
      ],
      "automatable": false
    },
    {
      "code": "RPL-AUTH-004",
      "category": "AUTH",
      "severity": "error",
      "message": "OIDC authorization code exchange failed — invalid code, expired code, or PKCE mismatch",
      "gate": "test:integration",
      "remediation": [
        "Authorization codes are single-use — ensure the code is not being replayed",
        "Codes expire quickly (typically 60s) — check for latency in the callback handler",
        "PKCE mismatch: ensure the same code_verifier is used for both authorization and token exchange",
        "Verify client_secret is correct if using confidential client authentication"
      ],
      "automatable": false
    },
    {
      "code": "RPL-FEEDBACK-001",
      "category": "FEEDBACK",
      "severity": "error",
      "message": "Fleet feedback envelope validation failed — payload does not conform to ripple-fleet-feedback/v1 schema",
      "gate": "fleet:feedback",
      "remediation": [
        "Run: pnpm fleet:feedback -- --type=<type> --title=\"...\" --dry-run to preview the payload",
        "Ensure required fields are present: feedbackType, title, description",
        "Valid feedback types: feature-request, bug-report, policy-exception, improvement-share, pain-point",
        "Check docs/fleet-feedback-schema.json for full schema"
      ],
      "automatable": true
    },
    {
      "code": "RPL-FEEDBACK-002",
      "category": "FEEDBACK",
      "severity": "info",
      "message": "Duplicate fleet feedback detected — similar feedback already exists in upstream",
      "gate": "fleet:feedback-intake",
      "remediation": [
        "Check existing upstream issues for duplicates before submitting",
        "Use --json flag to get the duplicate issue URL",
        "Consider adding a comment to the existing issue instead of creating a new one"
      ],
      "automatable": false
    },
    {
      "code": "RPL-FEEDBACK-003",
      "category": "FEEDBACK",
      "severity": "info",
      "message": "Fleet feedback submitted successfully — upstream issue created",
      "gate": "fleet:feedback",
      "remediation": [
        "No action required — feedback has been submitted",
        "Track the upstream issue URL returned in the --json output",
        "Upstream team will triage within the configured SLA"
      ],
      "automatable": false
    },
    {
      "code": "RPL-FEEDBACK-004",
      "category": "FEEDBACK",
      "severity": "error",
      "message": "Fleet feedback submission failed — could not create upstream issue",
      "gate": "fleet:feedback",
      "remediation": [
        "Check FLEET_FEEDBACK_TOKEN is set and has issues:write scope on the upstream repo",
        "Verify network connectivity to GitHub API",
        "Run with --dry-run to validate payload without submitting",
        "Retry: pnpm fleet:feedback -- --submit (exit code 2 = submission failed)"
      ],
      "automatable": false
    },
    {
      "code": "RPL-PERF-001",
      "category": "PERF",
      "severity": "error",
      "message": "Critical Core Web Vitals regression — metric exceeds 'poor' threshold (LCP > 4s, CLS > 0.25, FCP > 3s, TTFB > 1.8s, TBT > 600ms)",
      "gate": "perf-audit",
      "remediation": [
        "Run pnpm test:perf -- --json to identify the failing metric and route",
        "LCP: reduce render-blocking resources, optimize images, preload critical assets",
        "CLS: set explicit dimensions on images/embeds, avoid dynamic content injection above the fold",
        "FCP: reduce server response time, eliminate render-blocking CSS/JS",
        "TTFB: check server performance, enable caching, reduce redirects",
        "TBT: break up long tasks, defer non-critical JavaScript, use web workers"
      ],
      "automatable": false
    },
    {
      "code": "RPL-PERF-002",
      "category": "PERF",
      "severity": "warning",
      "message": "Moderate Core Web Vitals regression — metric exceeds 'needs improvement' threshold (LCP > 2.5s, CLS > 0.1, FCP > 1.8s, TTFB > 800ms, TBT > 200ms)",
      "gate": "perf-audit",
      "remediation": [
        "Run pnpm test:perf -- --json to identify the affected metric and route",
        "Review recent changes for performance impact (bundle size, network requests, DOM size)",
        "Non-blocking but should be addressed before reaching critical thresholds"
      ],
      "automatable": false
    }
  ]
}
