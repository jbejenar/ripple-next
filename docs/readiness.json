{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Ripple Next Readiness Manifest",
  "description": "Machine-readable subsystem status for agent planning. Updated 2026-02-28. See ADR-018 for AI-first workflow strategy and ADR-019 for fleet governance.",
  "version": "0.17.0",
  "subsystems": {
    "auth": {
      "status": "implemented",
      "description": "OIDC/OAuth provider-agnostic auth via oauth4webapi. MockAuthProvider for tests, OidcAuthProvider for local dev and production (configurable OIDC issuer). Authorization Code Flow with PKCE, database-backed sessions. Conformance test suite validates provider contract.",
      "packages": ["@ripple/auth"],
      "blockers": ["No integration tests for production OIDC flow yet"],
      "testCoverage": "conformance-tested"
    },
    "database": {
      "status": "implemented",
      "description": "Drizzle ORM with PostgreSQL. Schema for users, projects, audit_log, sessions. Repository pattern implemented. Migrations working. Testcontainers integration tests for UserRepository and ProjectRepository validate CRUD, unique constraints, and foreign key relationships against real PostgreSQL 17.",
      "packages": ["@ripple/db"],
      "blockers": [],
      "testCoverage": "integration-tested"
    },
    "queue": {
      "status": "implemented",
      "description": "Full provider pattern: MemoryQueueProvider (test), BullMQQueueProvider (local), SqsQueueProvider (prod). Consumer pattern with DLQ retry logic. Conformance test suite validates provider contract.",
      "packages": ["@ripple/queue"],
      "blockers": [],
      "testCoverage": "conformance-tested"
    },
    "storage": {
      "status": "implemented",
      "description": "Full provider pattern: FilesystemStorageProvider (test), MinioStorageProvider (local), S3StorageProvider (prod). Presigned URL support. Conformance test suite validates provider contract.",
      "packages": ["@ripple/storage"],
      "blockers": [],
      "testCoverage": "conformance-tested"
    },
    "email": {
      "status": "implemented",
      "description": "Full provider pattern: MemoryEmailProvider (test), SmtpEmailProvider (local/Mailpit), SesEmailProvider (prod). Conformance test suite validates provider contract.",
      "packages": ["@ripple/email"],
      "blockers": [],
      "testCoverage": "conformance-tested"
    },
    "events": {
      "status": "implemented",
      "description": "Domain event bus: MemoryEventBus (test/local), EventBridgeBus (prod). Typed domain events for users, projects. Conformance test suite validates bus contract.",
      "packages": ["@ripple/events"],
      "blockers": [],
      "testCoverage": "conformance-tested"
    },
    "ui": {
      "status": "implemented",
      "description": "Ripple UI component library with atoms (Button, Icon, FormInput, Checkbox, Radio, Dropdown, DateInput, Textarea, FileUpload, FormAlert, OptionButton, Breadcrumb, SkipLink, Alert, Callout, Acknowledgement, BlockQuote, Tag, Chip), molecules (Card, HeroHeader, Navigation, Pagination, InPageNavigation, Tabs, SearchBar, RelatedLinks, Table, StatisticsGrid, CategoryGrid, ResultsListing, DetailList, MediaGallery, DocumentDownload), organisms (Header, Footer), and Tide-compatible content section renderers (Accordion, CardCollection, Timeline, CallToAction, KeyDates, ContentImage, EmbeddedVideo, Wysiwyg). 44 components total. Page templates (RN-023): 3 content-type-aware templates (Landing, Content, Campaign) in apps/web/components/templates/ — compose UI components into distinct layouts, switched by CMS page contentType field. Media components (RN-021): MediaGallery with keyboard-accessible lightbox and responsive grid; DocumentDownload with file type icons and size formatting. Data display components (Table, StatisticsGrid, CategoryGrid, ResultsListing, DetailList) for sortable tables, metric grids, category browsing, search results, and key-value detail lists. Interactive pattern components (Tabs, SearchBar, Tag, Chip, RelatedLinks) for tabbed navigation, site search, inline labels, filter chips, and contextual link lists. Messaging components (Alert, Callout, Acknowledgement, BlockQuote) for page-level notifications, callout boxes, acknowledgement of country/people, and attributed quotes. Navigation components (Breadcrumb, Pagination, InPageNavigation, SkipLink) with WCAG 2.1 AA compliance. Form validation composable (useRplFormValidation) with common government form rules. Storybook stories with autodocs and @storybook/addon-a11y for all components. Vue Test Utils component tests for all components (478 tests) with coverage of props, events, accessibility (WCAG 2.1 AA), and interactive state. Accessibility audit pipeline (RN-042): axe-core in Playwright E2E tests, standalone pnpm test:a11y with structured JSON reports.",
      "packages": ["@ripple/ui"],
      "paths": ["apps/web/components/templates/"],
      "blockers": [],
      "testCoverage": "component-tested + storybook-stories + template-tested + a11y-audited"
    },
    "api": {
      "status": "partial",
      "description": "tRPC routers wired to @ripple/db repositories. User router supports me/getById/create/list via UserRepository. Health endpoint checks DB and Redis connectivity with latency metrics. Contract tests validate auth enforcement, input validation, and error codes. Database repositories have Testcontainers integration tests.",
      "packages": [],
      "paths": ["apps/web/server/trpc/", "apps/web/server/api/"],
      "blockers": [
        "No integration tests for tRPC routers with real DB (Testcontainers)"
      ],
      "testCoverage": "contract-tested + db-integration-tested"
    },
    "infrastructure": {
      "status": "implemented",
      "description": "SST v3 config with VPC, Aurora Postgres, Redis, DynamoDB, S3, SQS queues, EventBridge, Lambda consumers, ECS Fargate services, Cron jobs, Nuxt app. IaC policy scanning (RN-036): 7 policies covering security, safety, cost, and reliability. Machine-readable reports (ripple-iac-report/v1). Exception workflow via inline comments. LocalStack explicitly not required (ADR-015).",
      "packages": [],
      "paths": ["sst.config.ts", "docs/iac-policies.json", "scripts/iac-policy-scan.mjs"],
      "blockers": [],
      "testCoverage": "preview-deploys + iac-policy-scanned"
    },
    "ci": {
      "status": "implemented",
      "description": "Tiered CI pipeline: Tier 1 (lint/typecheck/env-schema-validation/unit on every PR with path filtering + readiness drift guard + quarantine policy check + IaC policy scan for sst.config.ts changes), Tier 2 (E2E on merge or high-risk changes). Security pipeline (CodeQL SAST, dependency review, secret audit). Preview deploys per PR with GitHub environment protection and label-gated deployment (ADR-014). Bootstrap doctor script with --json and --offline modes, exact version guards for Node.js (.nvmrc) and pnpm (packageManager). Zod-based env schema validation gate (ADR-012). Flaky test containment policy with quarantine check (ADR-013). IaC policy scanning with 7 policies for SST config (RN-036). no-console promoted to error. Risk-tiered coverage thresholds configured. JUnit XML test artifact uploads with 30-day retention. Reusable composite actions for setup, quality, and test — all reading pinned versions from .nvmrc and packageManager field (RN-032). SBOM generation mandatory (fail-fast, CycloneDX) and build provenance attestations in release workflow. Unified pnpm test:ci entrypoint.",
      "packages": [],
      "paths": [".github/workflows/", ".github/actions/", "docs/downstream-workflows.md", "docs/fleet-policy.json"],
      "blockers": [],
      "testCoverage": "pipeline-tested"
    },
    "testing-infra": {
      "status": "implemented",
      "description": "Mock providers bundle (including CMS), test factories (Fishery), Testcontainers helper, Vitest workspace config, Playwright setup. Provider conformance test suites for auth, queue, email, storage, events, and CMS. Flaky test containment policy (ADR-013): quarantine convention, 14-day time box, 5% budget cap, Tier 1 protection, pnpm check:quarantine CI gate. Testcontainers integration tests for database repositories.",
      "packages": ["@ripple/testing"],
      "blockers": [],
      "testCoverage": "conformance-suites-used-by-providers"
    },
    "publishing": {
      "status": "implemented",
      "description": "Hybrid monorepo model: packages developed in monorepo, published to private npm registry for external consumption. publishConfig and dist exports added to all packages. Changesets configured for version management. Release CI workflow builds, validates exports, publishes, generates CycloneDX SBOM, attests build provenance, and generates per-package SHA-256 checksums (RN-027). Verification CLI (pnpm verify:release) validates installed packages against checksums manifest. See ADR-007, ADR-010, and docs/release-verification.md.",
      "packages": ["all @ripple/* packages"],
      "paths": ["scripts/verify-release.mjs", "docs/release-verification.md"],
      "blockers": [],
      "testCoverage": "release-workflow-validated"
    },
    "cms": {
      "status": "implemented",
      "description": "CMS content layer with full Drupal/Tide integration and explicit decoupling architecture. Provider pattern: MockCmsProvider (test/local), DrupalCmsProvider (JSON:API client for Tide), SearchEnhancedCmsProvider (decorator for dedicated search engines). CmsProvider interface covers pages, taxonomies, menus, routes, and search. Full Tide paragraph-to-section mapping (accordion, card-collection, timeline, CTA, key-dates, embedded-video, image, wysiwyg). Provider factory with dynamic imports for tree-shakeable Drupal code. Drupal isolated to exactly 2 files (drupal.ts + tide-paragraph-mapper.ts) — removable without touching frontend, tests, or API layer. MeiliSearch integration for local dev search. See ADR-011.",
      "packages": ["@ripple/cms"],
      "paths": ["apps/web/server/api/cms/", "apps/web/composables/useCms.ts", "apps/web/composables/useNavigation.ts", "apps/web/pages/content/"],
      "blockers": [
        "No integration test with live Drupal/Tide instance (awaiting URLs)"
      ],
      "testCoverage": "conformance-tested + unit-tested + search-tested"
    },
    "navigation": {
      "status": "implemented",
      "description": "Navigation composable (useNavigation) loads header and footer menus from CMS provider. RplNavigation component supports horizontal (header) and vertical (footer) variants with nested menu structures. Wired into default layout. Fully tested with Vue Test Utils.",
      "packages": ["@ripple/ui"],
      "paths": ["apps/web/composables/useNavigation.ts", "apps/web/layouts/default.vue"],
      "blockers": [],
      "testCoverage": "component-tested"
    },
    "agent-tooling": {
      "status": "implemented",
      "description": "AI-first agent workflow tooling. Quality gate summaries (RN-034), code generators (RN-041), error taxonomy with 44 classified failure modes across 11 categories including fleet governance, accessibility, and session observability codes (RN-040, RN-042, RN-043), runbook library with 7 structured runbooks and CLI runner (RN-039), IaC policy scanner (RN-036), accessibility audit pipeline (RN-042), agent session observability with session logger and metrics aggregation (RN-043). Strategy documented in ADR-018.",
      "packages": [],
      "paths": ["scripts/verify.mjs", "scripts/generate/index.mjs", "scripts/a11y-audit.mjs", "scripts/session-logger.mjs", "scripts/agent-metrics.mjs", "docs/error-taxonomy.json", "docs/runbooks/", "scripts/runbook.mjs", "scripts/iac-policy-scan.mjs", "docs/iac-policies.json", "docs/accessibility.md", "docs/session-observability.md"],
      "blockers": [],
      "testCoverage": "gate-tested"
    },
    "fleet-governance": {
      "status": "implemented",
      "description": "Fleet governance mechanism for downstream repos (RN-024). Fleet policy contract (fleet-policy.json) defines 8 governed surfaces across 3 severity levels. Drift detection engine (check-fleet-drift.mjs) compares downstream repos against golden-path source. Sync PR automation for security/standards updates. Fleet compliance reporting (fleet-compliance.mjs) with aggregate scores. Error taxonomy integration (RPL-FLEET-* codes). Fleet sync runbook. See ADR-019.",
      "packages": [],
      "paths": ["docs/fleet-policy.json", "scripts/check-fleet-drift.mjs", "scripts/fleet-sync.mjs", "scripts/fleet-compliance.mjs", ".github/workflows/fleet-drift.yml", ".github/workflows/fleet-sync.yml", ".github/actions/fleet-drift/action.yml", "docs/runbooks/fleet-sync.json"],
      "blockers": [],
      "testCoverage": "gate-tested"
    }
  },
  "upstreamRipple": {
    "repository": "https://github.com/dpc-sdp/ripple",
    "lastReviewedVersion": "v2.49.1",
    "lastReviewDate": "2026-02-28",
    "syncPolicy": "Quarterly review. See CONTRIBUTING.md and ADR-017.",
    "ported": 42,
    "upstream": 46,
    "gap": 4
  },
  "statusLegend": {
    "implemented": "Core functionality working and tested at some level",
    "partial": "Interface defined, some implementations working, gaps remain",
    "scaffold": "Structure exists but returns placeholder/mock data",
    "planned": "Architecture decided but no implementation yet"
  }
}
