{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Ripple Next Readiness Manifest",
  "description": "Machine-readable subsystem status for agent planning. Updated 2026-02-28. See ADR-018 for AI-first workflow strategy.",
  "version": "0.12.0",
  "subsystems": {
    "auth": {
      "status": "implemented",
      "description": "OIDC/OAuth provider-agnostic auth via oauth4webapi. MockAuthProvider for tests, OidcAuthProvider for local dev and production (configurable OIDC issuer). Authorization Code Flow with PKCE, database-backed sessions. Conformance test suite validates provider contract.",
      "packages": ["@ripple/auth"],
      "blockers": ["No integration tests for production OIDC flow yet"],
      "testCoverage": "conformance-tested"
    },
    "database": {
      "status": "implemented",
      "description": "Drizzle ORM with PostgreSQL. Schema for users, projects, audit_log, sessions. Repository pattern implemented. Migrations working. Testcontainers integration tests for UserRepository and ProjectRepository validate CRUD, unique constraints, and foreign key relationships against real PostgreSQL 17.",
      "packages": ["@ripple/db"],
      "blockers": [],
      "testCoverage": "integration-tested"
    },
    "queue": {
      "status": "implemented",
      "description": "Full provider pattern: MemoryQueueProvider (test), BullMQQueueProvider (local), SqsQueueProvider (prod). Consumer pattern with DLQ retry logic. Conformance test suite validates provider contract.",
      "packages": ["@ripple/queue"],
      "blockers": [],
      "testCoverage": "conformance-tested"
    },
    "storage": {
      "status": "implemented",
      "description": "Full provider pattern: FilesystemStorageProvider (test), MinioStorageProvider (local), S3StorageProvider (prod). Presigned URL support. Conformance test suite validates provider contract.",
      "packages": ["@ripple/storage"],
      "blockers": [],
      "testCoverage": "conformance-tested"
    },
    "email": {
      "status": "implemented",
      "description": "Full provider pattern: MemoryEmailProvider (test), SmtpEmailProvider (local/Mailpit), SesEmailProvider (prod). Conformance test suite validates provider contract.",
      "packages": ["@ripple/email"],
      "blockers": [],
      "testCoverage": "conformance-tested"
    },
    "events": {
      "status": "implemented",
      "description": "Domain event bus: MemoryEventBus (test/local), EventBridgeBus (prod). Typed domain events for users, projects. Conformance test suite validates bus contract.",
      "packages": ["@ripple/events"],
      "blockers": [],
      "testCoverage": "conformance-tested"
    },
    "ui": {
      "status": "implemented",
      "description": "Ripple UI component library with atoms (Button, Icon, FormInput), molecules (Card, HeroHeader, Navigation), organisms (Header, Footer), and Tide-compatible content section renderers (Accordion, CardCollection, Timeline, CallToAction, KeyDates, ContentImage, EmbeddedVideo, Wysiwyg). 16 components total. Storybook stories with autodocs for all components. Vue Test Utils component tests for all components with coverage of props, events, accessibility, and interactive state.",
      "packages": ["@ripple/ui"],
      "blockers": [],
      "testCoverage": "component-tested + storybook-stories"
    },
    "api": {
      "status": "partial",
      "description": "tRPC routers wired to @ripple/db repositories. User router supports me/getById/create/list via UserRepository. Health endpoint checks DB and Redis connectivity with latency metrics. Contract tests validate auth enforcement, input validation, and error codes. Database repositories have Testcontainers integration tests.",
      "packages": [],
      "paths": ["apps/web/server/trpc/", "apps/web/server/api/"],
      "blockers": [
        "No integration tests for tRPC routers with real DB (Testcontainers)"
      ],
      "testCoverage": "contract-tested + db-integration-tested"
    },
    "infrastructure": {
      "status": "implemented",
      "description": "SST v3 config with VPC, Aurora Postgres, Redis, DynamoDB, S3, SQS queues, EventBridge, Lambda consumers, ECS Fargate services, Cron jobs, Nuxt app. LocalStack explicitly not required (ADR-015).",
      "packages": [],
      "paths": ["sst.config.ts"],
      "blockers": [],
      "testCoverage": "preview-deploys"
    },
    "ci": {
      "status": "implemented",
      "description": "Tiered CI pipeline: Tier 1 (lint/typecheck/env-schema-validation/unit on every PR with path filtering + readiness drift guard + quarantine policy check), Tier 2 (E2E on merge or high-risk changes). Security pipeline (CodeQL SAST, dependency review, secret audit). Preview deploys per PR with GitHub environment protection and label-gated deployment (ADR-014). Bootstrap doctor script with --json and --offline modes, exact version guards for Node.js (.nvmrc) and pnpm (packageManager). Zod-based env schema validation gate (ADR-012). Flaky test containment policy with quarantine check (ADR-013). no-console promoted to error. Risk-tiered coverage thresholds configured. JUnit XML test artifact uploads with 30-day retention. Reusable composite actions for setup, quality, and test — all reading pinned versions from .nvmrc and packageManager field (RN-032). SBOM generation mandatory (fail-fast, CycloneDX) and build provenance attestations in release workflow. Unified pnpm test:ci entrypoint.",
      "packages": [],
      "paths": [".github/workflows/", ".github/actions/", "docs/downstream-workflows.md"],
      "blockers": [],
      "testCoverage": "pipeline-tested"
    },
    "testing-infra": {
      "status": "implemented",
      "description": "Mock providers bundle (including CMS), test factories (Fishery), Testcontainers helper, Vitest workspace config, Playwright setup. Provider conformance test suites for auth, queue, email, storage, events, and CMS. Flaky test containment policy (ADR-013): quarantine convention, 14-day time box, 5% budget cap, Tier 1 protection, pnpm check:quarantine CI gate. Testcontainers integration tests for database repositories.",
      "packages": ["@ripple/testing"],
      "blockers": [],
      "testCoverage": "conformance-suites-used-by-providers"
    },
    "publishing": {
      "status": "implemented",
      "description": "Hybrid monorepo model: packages developed in monorepo, published to private npm registry for external consumption. publishConfig and dist exports added to all packages. Changesets configured for version management. Release CI workflow builds, validates exports, publishes, generates CycloneDX SBOM, and attests build provenance. See ADR-007 and ADR-010.",
      "packages": ["all @ripple/* packages"],
      "blockers": [],
      "testCoverage": "release-workflow-validated"
    },
    "cms": {
      "status": "implemented",
      "description": "CMS content layer with full Drupal/Tide integration and explicit decoupling architecture. Provider pattern: MockCmsProvider (test/local), DrupalCmsProvider (JSON:API client for Tide), SearchEnhancedCmsProvider (decorator for dedicated search engines). CmsProvider interface covers pages, taxonomies, menus, routes, and search. Full Tide paragraph-to-section mapping (accordion, card-collection, timeline, CTA, key-dates, embedded-video, image, wysiwyg). Provider factory with dynamic imports for tree-shakeable Drupal code. Drupal isolated to exactly 2 files (drupal.ts + tide-paragraph-mapper.ts) — removable without touching frontend, tests, or API layer. MeiliSearch integration for local dev search. See ADR-011.",
      "packages": ["@ripple/cms"],
      "paths": ["apps/web/server/api/cms/", "apps/web/composables/useCms.ts", "apps/web/composables/useNavigation.ts", "apps/web/pages/content/"],
      "blockers": [
        "No integration test with live Drupal/Tide instance (awaiting URLs)"
      ],
      "testCoverage": "conformance-tested + unit-tested + search-tested"
    },
    "navigation": {
      "status": "implemented",
      "description": "Navigation composable (useNavigation) loads header and footer menus from CMS provider. RplNavigation component supports horizontal (header) and vertical (footer) variants with nested menu structures. Wired into default layout. Fully tested with Vue Test Utils.",
      "packages": ["@ripple/ui"],
      "paths": ["apps/web/composables/useNavigation.ts", "apps/web/layouts/default.vue"],
      "blockers": [],
      "testCoverage": "component-tested"
    },
    "agent-tooling": {
      "status": "partial",
      "description": "AI-first agent workflow tooling. Machine-readable quality gate summaries via pnpm verify --json (RN-034). Code generators via pnpm generate:* (RN-041): component, provider, endpoint, package scaffolding with --dry-run support. Remaining: runbook automation (RN-039), structured error taxonomy (RN-040), agent session observability (RN-043). Strategy documented in ADR-018.",
      "packages": [],
      "paths": ["scripts/verify.mjs", "scripts/generate/index.mjs"],
      "blockers": [
        "Runbooks not yet created (RN-039)",
        "Error taxonomy not yet defined (RN-040)"
      ],
      "testCoverage": "gate-tested"
    }
  },
  "statusLegend": {
    "implemented": "Core functionality working and tested at some level",
    "partial": "Interface defined, some implementations working, gaps remain",
    "scaffold": "Structure exists but returns placeholder/mock data",
    "planned": "Architecture decided but no implementation yet"
  }
}
